
<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>ë°©ë‘ ê¸¸ë“œ</title>
  <link rel="preconnect" href="https://cdn.jsdelivr.net">
  <style>
    body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Noto Sans KR,sans-serif;background:#fff7fb;color:#1f1f24}
    header{padding:24px;text-align:center}
    h1{margin:0}
    main{max-width:1100px;margin:0 auto;padding:16px}
    .section{margin-top:28px}
    .grid{display:grid;grid-template-columns:repeat(3,1fr);gap:12px}
    @media(max-width:800px){.grid{grid-template-columns:repeat(2,1fr)}}
    @media(max-width:500px){.grid{grid-template-columns:1fr}}
    .card{background:#fff;border-radius:14px;overflow:hidden;box-shadow:0 8px 24px rgba(0,0,0,.08)}
    .thumb{aspect-ratio:1/1}
    .thumb img{width:100%;height:100%;object-fit:cover}
    .row{display:flex;justify-content:space-between;align-items:center}
    a.btn{display:inline-block;margin-top:12px;padding:10px 14px;border-radius:12px;background:#f48fb1;color:#fff;text-decoration:none;font-weight:700}
  </style>
</head>
<body>
<header>
  <h1>ğŸŒ¸ ë°©ë‘ ê¸¸ë“œ</h1>
  <p>ë§ˆë¹„ë…¸ê¸° ëª¨ë°”ì¼ Â· ììœ ë¡­ê³  ë”°ëœ»í•œ ê¸¸ë“œ</p>
</header>

<main>
  <section class="section">
    <h2>ğŸ“· ìµœê·¼ ì‚¬ì§„</h2>
    <div id="photos" class="grid"></div>
    <a class="btn" href="/photos.html">ì‚¬ì§„ ê²Œì‹œíŒ ë°”ë¡œê°€ê¸°</a>
  </section>
</main>

<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<script src="/supabase_config.js"></script>
<script>
  const supabase = window.supabase.createClient(window.SUPABASE_URL, window.SUPABASE_ANON_KEY);
  const BUCKET = "bangrang-photos";
  const TABLE = "photo_posts";

  async function loadPhotos(){
    const { data } = await supabase.from(TABLE).select("*").order("created_at",{ascending:false}).limit(6);
    const wrap = document.getElementById("photos");
    if(!data || data.length===0){wrap.innerHTML="<p>ì•„ì§ ì‚¬ì§„ì´ ì—†ì–´ìš”</p>";return;}
    data.forEach(r=>{
      const { data: pub } = supabase.storage.from(BUCKET).getPublicUrl(r.image_path);
      const d = document.createElement("div");
      d.className="card";
      d.innerHTML = `<div class="thumb"><img src="${pub.publicUrl}"></div>`;
      wrap.appendChild(d);
    });
  }
  loadPhotos();
</script>
</body>
</html>
